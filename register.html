<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Register - Coffee Bliss</title>
  <link rel="stylesheet" href="css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
  <!-- Hero Background -->
  <section class="hero-register">
    <div class="hero-overlay"></div>

    <!-- Header -->
    <header class="login-header">
    <a href="index.html" class="brand">EcomStore</a>
    <a href="index.html" class="btn-home"><i class="bi bi-house-door"></i> Home</a>
    </header>

    <!-- Register Box -->
    <div class="register-box">
      <h2>Create Account</h2>
      <p>Lets set up the trend!</p>

      <form id="registerForm">
        <div class="form-group">
          <input type="text" id="name" placeholder="Full Name" required>
        </div>
        <div class="form-group">
          <input type="email" id="email" placeholder="Email Address" required>
        </div>
        <div class="form-group">
          <input type="password" id="password" placeholder="Password" required>
        </div>
        <div class="form-group">
          <input type="password" id="confirmPassword" placeholder="Confirm Password" required>
        </div>
        <button type="submit" class="btn-gradient">Register</button>
      </form>

      <p class="login-link">Already have an account? <a href="login.html">Login here</a></p>
    </div>
  </section>

  <script>
    document.getElementById('registerForm').addEventListener('submit', async (e) => {
      e.preventDefault();

      const name = document.getElementById('name').value;
      const email = document.getElementById('email').value;
      const password = document.getElementById('password').value;
      const confirmPassword = document.getElementById('confirmPassword').value;

      if (password !== confirmPassword) {
        return alert('❌ Passwords do not match');
      }

      try {
        const res = await fetch('http://localhost:5000/api/register', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ name, email, password })
        });

        const data = await res.json();

        if (data.success) {
          alert('✅ Registration successful!');

          // Auto-login: save user to localStorage
          localStorage.setItem('user', JSON.stringify({
            id: data.id || null,   // optional, in case you want to store ID later
            name: name,
            email: email
          }));

          // Redirect to homepage
          window.location.href = 'index.html';
        } else {
          alert('❌ ' + (data.error || 'Registration failed'));
        }

      } catch (err) {
        console.error(err);
        alert('⚠️ Server error');
      }
    });
  </script>
</body>

</html>
